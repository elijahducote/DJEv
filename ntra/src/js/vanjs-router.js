(()=>{var B=Object.defineProperty;var l=(t,e)=>B(t,"name",{value:e,configurable:!0});var J=Object.defineProperty,Q=l((t,e,r)=>e in t?J(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,"__defNormalProp"),d=l((t,e,r)=>Q(t,typeof e!="symbol"?e+"":e,r),"__publicField"),h=Object.getPrototypeOf,w,b,o,f,N={isConnected:1},U=1e3,g,A={},X=h(N),M=h(h),u,W=l((t,e,r,s)=>(t??(setTimeout(r,s),new Set)).add(e),"addAndScheduleOnFirst"),G=l((t,e,r)=>{let s=o;o=e;try{return t(r)}catch(n){return console.error(n),r}finally{o=s}},"runAndCaptureDeps"),y=l(t=>t.filter(e=>{var r;return(r=e._dom)==null?void 0:r.isConnected}),"keepConnected"),I=l(t=>g=W(g,t,()=>{for(let e of g)e._bindings=y(e._bindings),e._listeners=y(e._listeners);g=u},U),"addStatesToGc"),S={get val(){var t;return(t=o?._getters)==null||t.add(this),this.rawVal},get oldVal(){var t;return(t=o?._getters)==null||t.add(this),this._oldVal},set val(t){var e;(e=o?._setters)==null||e.add(this),t!==this.rawVal&&(this.rawVal=t,this._bindings.length+this._listeners.length?(b?.add(this),w=W(w,this,Y)):this._oldVal=t)}},R=l(t=>({__proto__:S,rawVal:t,_oldVal:t,_bindings:[],_listeners:[]}),"state"),m=l((t,e)=>{let r={_getters:new Set,_setters:new Set},s={f:t},n=f;f=[];let i=G(t,r,e);i=(i??document).nodeType?i:new Text(i);for(let a of r._getters)r._setters.has(a)||(I(a),a._bindings.push(s));for(let a of f)a._dom=i;return f=n,s._dom=i},"bind"),O=l((t,e=R(),r)=>{let s={_getters:new Set,_setters:new Set},n={f:t,s:e};n._dom=r??f?.push(n)??N,e.val=G(t,s,e.rawVal);for(let i of s._getters)s._setters.has(i)||(I(i),i._listeners.push(n));return e},"derive"),K=l((t,...e)=>{for(let r of e.flat(1/0)){let s=h(r??0),n=s===S?m(()=>r.val):s===M?m(r):r;n!=u&&t.append(n)}return t},"add"),$=l((t,e,...r)=>{var s;let[n,...i]=h(r[0]??0)===X?r:[{},...r],a=t?document.createElementNS(t,e):document.createElement(e);for(let[p,_]of Object.entries(n)){let F=l(v=>v?Object.getOwnPropertyDescriptor(v,p)??F(h(v)):u,"getPropDescriptor"),C=e+","+p,D=A[C]??(A[C]=((s=F(h(a)))==null?void 0:s.set)??0),x=p.startsWith("on")?(v,z)=>{let j=p.slice(2);a.removeEventListener(j,z),a.addEventListener(j,v)}:D?D.bind(a):a.setAttribute.bind(a,p),V=h(_??0);p.startsWith("on")||V===M&&(_=O(_),V=S),V===S?m(()=>(x(_.val,_._oldVal),a)):x(_)}return K(a,i)},"tag"),T=l(t=>({get:l((e,r)=>$.bind(u,t,r),"get")}),"handler"),q=l((t,e)=>e?e!==t&&t.replaceWith(e):t.remove(),"update"),Y=l(()=>{let t=0,e=[...w].filter(s=>s.rawVal!==s._oldVal);do{b=new Set;for(let s of new Set(e.flatMap(n=>n._listeners=y(n._listeners))))O(s.f,s.s,s._dom),s._dom=u}while(++t<100&&(e=[...b]).length);let r=[...w].filter(s=>s.rawVal!==s._oldVal);w=u;for(let s of new Set(r.flatMap(n=>n._bindings=y(n._bindings))))q(s._dom,m(s.f,s._dom)),s._dom=u;for(let s of r)s._oldVal=s.rawVal},"updateDoms"),E={tags:new Proxy(t=>new Proxy($,T(t)),T()),hydrate:l((t,e)=>q(t,m(e,t)),"hydrate"),add:K,state:R,derive:O},P=l(()=>location.pathname.slice(1)||"home","nowPath"),c=E.state(P());window.addEventListener("popstate",()=>{c.val=P()});var L=class{static{l(this,"Handler")}constructor(e){if(d(this,"rule"),d(this,"args",[]),d(this,"Loader"),d(this,"delayed",!1),d(this,"onFirst"),d(this,"onLoad"),d(this,"element"),d(this,"isFirstLoad",!0),!e)throw new Error("config cannot be empty");if(!e.rule)throw new Error("rule cannot be empty");if(!e.Loader)throw new Error("Loader cannot be empty");this.rule=e.rule,this.Loader=e.Loader,this.delayed=e.delayed||!1,this.onFirst=e.onFirst||(async()=>{}),this.onLoad=e.onLoad||(async()=>{}),this.element=this.Loader(),this.element.hidden=!0,E.derive(()=>{let r=this.matchPath();r?l(async()=>{this.args.splice(0),this.args.push(...r.args),this.isFirstLoad&&(this.isFirstLoad=!1,await this.onFirst()),await this.onLoad(),this.delayed||this.show()},"func")():this.hide()})}matchPath(){if(this.rule instanceof RegExp){let r=c.val.match(this.rule);return r?{path:c.val,args:[...r].slice(1)}:!1}let e=c.val.split("/").filter(r=>r.length>0);return e.length<1&&e.push("home"),e[0]==this.rule?{path:c.val,args:e.slice(1)}:!1}show(){this.element.hidden=!1}hide(){this.element.hidden=!0}},Z=l(t=>new L(t).element,"Route"),H=l((t,...e)=>{let r=t==="home"&&e.length===0?"/":`/${[t,...e].join("/")}`;history.pushState(null,"",r),c.val=P()},"goto"),k={nowPath:P,now:c,Handler:L,Route:Z,goto:H};Object.defineProperty(window,"router",{value:k});Object.defineProperty(window,"van",{value:E});})();
